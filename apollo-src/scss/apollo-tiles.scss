// This program is part of the OpenCms Apollo Template.
//
// Copyright (c) Alkacon Software GmbH & Co. KG (http://www.alkacon.com)
//
// This program is free software: you can redistribute it and/or modify
// it under the terms of the GNU Affero General Public License as
// published by the Free Software Foundation, either version 3 of the
// License, or (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU Affero General Public License for more details.
// 
// You should have received a copy of the GNU Affero General Public License
// along with this program.  If not, see <http://www.gnu.org/licenses/>.

/**********
 *
 * apollo-tiles.scss
 *
 */

// Apollo tiles and squares
   
$ti-maxCols:    12 !default; 
$ti-margin:     0 !default;

// ALL columns: 1         2       3       4       5           6      8           10          12
//    $ti-cols: ((12, 12), (6, 6), (4, 4), (3, 3), (2o4, 2.4), (2,2), (1o5, 1.5), (1o2, 1.2), (1,1)) !default;

// REDUCED        4       5           6      8
$ti-cols:       ((3, 3), (2o4, 2.4), (2,2), (1o5, 1.5)) !default;

$sq-maxCols:    $ti-maxCols !default; 
$sq-margin:     0 !default;
$sq-margins:    $spacers !default;
$sq-cols:       ((12, 12), (6, 6), (4, 4), (3, 3), (2,2)) !default;
//                1/6            1/4           1/3           1/2          1.5           2
// $sq-heights: ((0o16, 0.166), (0o25, 0.25), (0o33, 0.332), (0o5, 0.5), (1o5, 1.499), (2, 2)) !default;
$sq-heights:    ((0o25, 0.25), (0o5, 0.5), (2, 2)) !default;
$sq-padding:    20 !default;

// $fix-cols:   (50, 100, 125, 150, 200, 250) !default;
$fix-cols:      (100, 125, 150, 200) !default;

$sizes:         ("xs", "sm", "md", "lg") !default;

// Squares

// For the basics of this square tile solution, see
// http://stackoverflow.com/questions/20456694/grid-of-responsive-squares

.ap-square { 
   // base definition that is used if no media query matches
   float: left;
   position: relative;
   width: 100%;
   padding: 0 0 100% 0 !important; // !important because the "padding-bottom: 100%" is what makes the squares sqaure
}

@mixin make-ap-square($size)   { 

    @each $i, $sq-i in $sq-cols { 
        $sq-width: 100%/($sq-maxCols/$sq-i);

        .square-#{$size}-#{$i} { 
           // creates the media query square versions like .square-md-5 etc.
            width: #{$sq-width};
            padding: 0 0 #{$sq-width} 0 !important;

            @each $h, $sq-h in $sq-heights {             

                &-h-#{$h} { 
                    // allows adjustmets of square height 
                    width: #{$sq-width};                          
                    padding: 0 0 #{$sq-width * $sq-h} 0 !important;            
                }
            }
        }
    }  
}

.ap-square .ap-square-section { 
    // required inner square class, the "position: absolute" does the trick 
    position: absolute !important; // !important because otherwise OpenCms ADE will mix up the grid
    height: 100%;
    width: 100%;
    margin: 0;
    background-position: center center;
    background-repeat: no-repeat;
    background-size: cover;
}

@each $m in $sq-margins  { 
    // allows to set the margin between squares
    .ap-square.square-m-#{$m} .ap-square-section {
        height: calc(100% - #{$m * 2}px);
        width:  calc(100% - #{$m * 2}px);
        margin: #{$m}px;
    }
}

.ap-sq-square { 
    // ensure we can have variable padding squares with hidden overflow
    width: 100%; 
    height: 100%;
    overflow: hidden;    
}

.ap-sq-table { 
    // table needed for aligment of content inside square
    display: table;  
    height: 100%;
    width: 100%;
}

.ap-sq-cell { 
    // table cell needed for aligment of content inside square
    display: table-cell;
    vertical-align: middle;
    height: 100%;
    width: 100%;
}

// Tiles

.ap-tile { 
    float: left;
    position: relative;
    min-height: 1px;
    white-space: nowrap;
    width: calc(100% - #{$ti-margin*2}px);
    margin: #{$ti-margin}px;
}


@mixin make-ap-tile($size)   {  

    @each $i, $ti-i in $ti-cols { 

        $ti-width: 100/($ti-maxCols/$ti-i);

        .tile-#{$size}-#{$i} {
            width: calc(#{$ti-width}% - #{$ti-margin*2}px);
            @if $i == $ti-maxCols {
                margin: #{$ti-margin}px 0;
            } @else {
                margin: #{$ti-margin}px;
            } 
        }
    }
}

// Fixed with columns
// I know that this is not what Bootstrap is about, but hey who cares ;)

.fixcol { 
    float: left;
    position: relative;
    min-height: 1px;
    padding-right: #{$gutter}px;
    padding-left: #{$gutter}px;
    width: 100%;
}

// fixed with column base instance
@each $i in $fix-cols { 
    @each $size in $sizes {
        .fixcol-#{$size}-#{$i},
        .fixcol-#{$size}-#{$i}-rest {
            @extend .fixcol;
        } 
    }
}

// creates a fixed with column
@mixin make-fixcol($size)   { 
    @each $i in $fix-cols { 
        // the fixed with column
        .fixcol-#{$size}-#{$i} { 
            // add the gutter so that the column pixel size is what the class says
            width: calc(#{$i}px + 2 * #{$gutter}px); 
        }
        // if fixed size ($i) is 0 we use the default 100%, otherwise the gutter would be substracted
        @if ($i > 0) { 
            // the rest of the column
            .fixcol-#{$size}-#{$i}-rest {
                width: calc(100% - (#{$i}px + 2 * #{$gutter}px));
            }
        }
    }
}

@include make-ap-square(xs);
@include make-ap-tile(xs);
@include make-fixcol(xs);

@media (min-width: $screen-sm-min){
    @include make-ap-square(sm);
    @include make-ap-tile(sm);
    @include make-fixcol(sm);
}

@media (min-width: $screen-md-min){
    @include make-ap-square(md);
    @include make-ap-tile(md);
    @include make-fixcol(md);
}

@media (min-width: $screen-lg-min){
    @include make-ap-square(lg);
    @include make-ap-tile(lg);
    @include make-fixcol(lg);
}
